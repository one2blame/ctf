FROM ubuntu:18.04

RUN DEBIAN_FRONTEND=noninteractive apt-get update -y && apt-get install -y \
    socat \
&& rm -rf /var/lib/apt/lists/*

RUN useradd -m BinEx101

WORKDIR /home/BinEx101

COPY BinEx101 .
COPY flag.txt .
RUN chown -R root:BinEx101 /home/BinEx101 && \
    chmod -R 750 /home/BinEx101 && \
    chmod 740 /home/BinEx101/flag.txt

EXPOSE 26435
USER BinEx101
CMD while true; do \
        socat TCP-LISTEN:26435,reuseaddr,fork EXEC:"./BinEx101",stderr; \
    done
